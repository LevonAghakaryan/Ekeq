{% extends "base.html" %}

{% block title %}Admin - ‘≤’∏’¨’∏÷Ä ’ä’°’ø’æ’•÷Ä’∂’•÷Ä’®{% endblock %}

{% block content %}
<section style="padding: 3rem 0;">
    <div class="container">
        <h1 style="margin-bottom: 2rem; color: #d4af37;">
            üì¶ ‘≤’∏’¨’∏÷Ä ’ä’°’ø’æ’•÷Ä’∂’•÷Ä’®
        </h1>

        <!-- ’é’´’≥’°’Ø’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
            <div style="background: #fff3cd; padding: 1.5rem; border-radius: 10px; text-align: center;">
                <h2 style="font-size: 2.5rem; color: #856404; margin-bottom: 0.5rem;">
                    {{ orders | selectattr('status', 'equalto', 'New') | list | length }}
                </h2>
                <p style="color: #856404; font-weight: 600;">üÜï ’Ü’∏÷Ä</p>
            </div>
            <div style="background: #d1ecf1; padding: 1.5rem; border-radius: 10px; text-align: center;">
                <h2 style="font-size: 2.5rem; color: #0c5460; margin-bottom: 0.5rem;">
                    {{ orders | selectattr('status', 'equalto', 'Pending') | list | length }}
                </h2>
                <p style="color: #0c5460; font-weight: 600;">‚è≥ ‘∏’∂’©’°÷Å÷Ñ’´ ’¥’•’ª</p>
            </div>
            <div style="background: #d4edda; padding: 1.5rem; border-radius: 10px; text-align: center;">
                <h2 style="font-size: 2.5rem; color: #155724; margin-bottom: 0.5rem;">
                    {{ orders | selectattr('status', 'equalto', 'Completed') | list | length }}
                </h2>
                <p style="color: #155724; font-weight: 600;">‚úÖ ‘±’æ’°÷Ä’ø’æ’°’Æ</p>
            </div>
            <div style="background: #e2e3e5; padding: 1.5rem; border-radius: 10px; text-align: center;">
                <h2 style="font-size: 2.5rem; color: #383d41; margin-bottom: 0.5rem;">{{ orders | length }}</h2>
                <p style="color: #383d41; font-weight: 600;">üìä ‘∏’∂’§’°’¥’•’∂’®</p>
            </div>
        </div>

        <!-- Orders Table -->
        <div style="background: white; border-radius: 15px; padding: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <h2 style="margin-bottom: 1.5rem;">‘≤’∏’¨’∏÷Ä ’∫’°’ø’æ’•÷Ä’∂’•÷Ä’®</h2>
            
            {% if orders %}
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f8f8f8; border-bottom: 2px solid #d4af37;">
                            <th style="padding: 1rem; text-align: left;">ID</th>
                            <th style="padding: 1rem; text-align: left;">’Ä’°’≥’°’≠’∏÷Ä’§</th>
                            <th style="padding: 1rem; text-align: left;">’Ä’•’º’°’≠’∏’Ω</th>
                            <th style="padding: 1rem; text-align: center;">‘ø’°’∫’´ ’¥’´’ª’∏÷Å</th>
                            <th style="padding: 1rem; text-align: left;">‘¥’´’¶’°’µ’∂</th>
                            <th style="padding: 1rem; text-align: center;">‘ø’°÷Ä’£’°’æ’´’≥’°’Ø</th>
                            <th style="padding: 1rem; text-align: left;">‘±’¥’Ω’°’©’´’æ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in orders %}
                        <tr style="border-bottom: 1px solid #e0e0e0;">
                            <td style="padding: 1rem;">
                                <strong>#{{ order.id }}</strong>
                            </td>
                            <td style="padding: 1rem;">
                                {{ order.customer_name }}
                            </td>
                            <td style="padding: 1rem;">
                                <a href="tel:{{ order.phone_number }}" style="color: #d4af37; text-decoration: none;">
                                    {{ order.phone_number }}
                                </a>
                            </td>
                            <td style="padding: 1rem; text-align: center;">
                                {% if order.preferred_contact == 'WhatsApp' %}
                                    <span style="background: #25d366; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.85rem;">üí¨ WhatsApp</span>
                                {% elif order.preferred_contact == 'Telegram' %}
                                    <span style="background: #0088cc; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.85rem;">‚úàÔ∏è Telegram</span>
                                {% elif order.preferred_contact == 'Viber' %}
                                    <span style="background: #665cac; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.85rem;">üìû Viber</span>
                                {% else %}
                                    <span style="background: #6c757d; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.85rem;">üì± ‘∂’°’∂’£</span>
                                {% endif %}
                            </td>
                            <td style="padding: 1rem;">
                                <a href="/product/{{ order.template.id }}" style="color: #d4af37; text-decoration: none;">
                                    {{ order.template.name }}
                                </a>
                            </td>
                            <td style="padding: 1rem; text-align: center;">
                                {% if order.status == 'New' %}
                                    <span style="background: #fff3cd; color: #856404; padding: 0.3rem 0.8rem; border-radius: 20px; font-weight: 600;">üÜï ’Ü’∏÷Ä</span>
                                {% elif order.status == 'Pending' %}
                                    <span style="background: #d1ecf1; color: #0c5460; padding: 0.3rem 0.8rem; border-radius: 20px; font-weight: 600;">‚è≥ ‘∏’∂’©’°÷Å÷Ñ’´ ’¥’•’ª</span>
                                {% else %}
                                    <span style="background: #d4edda; color: #155724; padding: 0.3rem 0.8rem; border-radius: 20px; font-weight: 600;">‚úÖ ‘±’æ’°÷Ä’ø’æ’°’Æ</span>
                                {% endif %}
                            </td>
                            <td style="padding: 1rem; color: #666; font-size: 0.9rem;">
                                {{ order.created_at.strftime('%Y-%m-%d %H:%M') }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p style="text-align: center; color: #999; padding: 2rem;">‘¥’•’º ’∫’°’ø’æ’•÷Ä’∂’•÷Ä ’π’Ø’°’∂</p>
            {% endif %}
        </div>

        <div style="margin-top: 2rem;">
            <a href="/catalog" class="btn btn-secondary">‚Üê ’é’•÷Ä’°’§’°’º’∂’°’¨</a>
        </div>
    </div>
</section>
{% endblock %}